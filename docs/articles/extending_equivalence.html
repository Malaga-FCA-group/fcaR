<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extending fcaR: Equivalence Rules for Implications â€¢ fcaR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Extending fcaR: Equivalence Rules for Implications">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fcaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/arules.html">Integration with the arules package</a>
    </li>
    <li>
      <a href="../articles/concept_lattice.html">Using FormalContexts and ConceptLattices</a>
    </li>
    <li>
      <a href="../articles/extending_equivalence.html">Extending fcaR: Equivalence Rules for Implications</a>
    </li>
    <li>
      <a href="../articles/implications.html">Working with ImplicationSets</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/neuroimaginador/fcaR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="extending_equivalence_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Extending fcaR: Equivalence Rules for Implications</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/neuroimaginador/fcaR/blob/master/vignettes/extending_equivalence.Rmd"><code>vignettes/extending_equivalence.Rmd</code></a></small>
      <div class="hidden name"><code>extending_equivalence.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this vignette, we present a way to extend the functionalities provided in the <code>fcaR</code> package: define new operations on an <code>ImplicationSet</code>.</p>
<p>First, we load the <code>fcaR</code> package by:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(fcaR)</span></code></pre></div>
<p>Let us use the <code>planets</code> dataset included in the package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>fc &lt;-<span class="st"> </span>FormalContext<span class="op">$</span><span class="kw">new</span>(planets)</span>
<span id="cb2-2"><a href="#cb2-2"></a>fc<span class="op">$</span><span class="kw">find_implications</span>()</span></code></pre></div>
</div>
<div id="the-registry" class="section level1">
<h1 class="hasAnchor">
<a href="#the-registry" class="anchor"></a>The Registry</h1>
<p>In <code>fcaR</code>, we have decided to use a <code>registry</code> from the <code>registry</code> package to store the operations that can be performed on an <code>ImplicationSet</code>. Currently, its purpose is to store equivalence rules, that is, methods that obtain equivalent <code>ImplicationSet</code>s from one given.</p>
<p>This registry is called <code>equivalencesRegistry</code> and one can inspect its contents by:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>equivalencesRegistry<span class="op">$</span><span class="kw">get_entry_names</span>()</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; [1] "Composition"    "Generalization" "Reduction"      "Simplification"</span></span></code></pre></div>
<p>These names correspond to the methods that are added to the registry by default, and are used to index those methods. Every method is accompanied by a description, so we can see its definition:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>equivalencesRegistry<span class="op">$</span><span class="kw">get_entry</span>(<span class="st">"Composition"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt;      method Composition</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt;         fun &lt;&lt;function&gt;&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; description A -&gt; B and A -&gt; C equivalent to A -&gt; BC</span></span></code></pre></div>
<p>We can even use abbreviated names to refer to the method:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>equivalencesRegistry<span class="op">$</span><span class="kw">get_entry</span>(<span class="st">"comp"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt;      method Composition</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt;         fun &lt;&lt;function&gt;&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt; description A -&gt; B and A -&gt; C equivalent to A -&gt; BC</span></span></code></pre></div>
</div>
<div id="use-of-the-rules" class="section level1">
<h1 class="hasAnchor">
<a href="#use-of-the-rules" class="anchor"></a>Use of the Rules</h1>
<p>As explained in the vignette corresponding to <code>ImplicationSet</code>s, we can use any of these methods by using the <code>apply_rules()</code> method in the <code>ImplicationSet</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>fc<span class="op">$</span>implications<span class="op">$</span><span class="kw">apply_rules</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"comp"</span>, <span class="st">"simp"</span>))</span></code></pre></div>
</div>
<div id="definition-of-new-equivalence-rules" class="section level1">
<h1 class="hasAnchor">
<a href="#definition-of-new-equivalence-rules" class="anchor"></a>Definition of New Equivalence Rules</h1>
<p>The way to extend the functionality in <code>fcaR</code> is to define new equivalence operators and include them in the registry.</p>
<p>In order to add a new method, we use:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>equivalencesRegistry<span class="op">$</span><span class="kw">set_entry</span>(<span class="dt">method =</span> <span class="st">"Method name"</span>,</span>
<span id="cb7-2"><a href="#cb7-2"></a>                               <span class="dt">fun =</span> method_function,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                               <span class="dt">description =</span> <span class="st">"Method description"</span>)</span></code></pre></div>
<p>where <code>method_function()</code> must be a function with the following scheme:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>method_function &lt;-<span class="st"> </span><span class="cf">function</span>(LHS, RHS, attributes) {</span>
<span id="cb8-2"><a href="#cb8-2"></a>  </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="co"># LHS and RHS are the sparse matrices of the left-hand and</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="co"># right-hand sides of the implications</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="co"># attributes is the vector of attribute names</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="co"># The three arguments are mandatory</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  </span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="co"># Perform operations on LHS and RHS</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="co"># ...</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>  </span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="co"># Must return a list with two components: lhs and rhs</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">lhs =</span> LHS,</span>
<span id="cb8-13"><a href="#cb8-13"></a>              <span class="dt">rhs =</span> RHS))</span>
<span id="cb8-14"><a href="#cb8-14"></a>  </span>
<span id="cb8-15"><a href="#cb8-15"></a>}</span></code></pre></div>
<p>The <code>method_function()</code> function must be defined before adding the method to the registry. Once the method is added, it can be executed by using the corresponding call to <code>apply_rules()</code>.</p>
</div>
<div id="an-example" class="section level1">
<h1 class="hasAnchor">
<a href="#an-example" class="anchor"></a>An Example</h1>
<p>Let us define an operator which reorders the implications according to the size of their LHS and RHS, such that implications with smaller LHS and RHS are first. Evidently, this operation provides an equivalent <code>ImplicationSet</code></p>
<p>In this case, we begin by defining the method function:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>reorder &lt;-<span class="st"> </span><span class="cf">function</span>(LHS, RHS, attributes) {</span>
<span id="cb9-2"><a href="#cb9-2"></a>  </span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="co"># Sizes of the LHS + size of the RHS</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="co"># Remember: attributes are in rows, implications are</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="co"># in columns.</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  sizes &lt;-<span class="st"> </span>Matrix<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span>(LHS) <span class="op">+</span><span class="st"> </span>Matrix<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span>(RHS)</span>
<span id="cb9-7"><a href="#cb9-7"></a>  </span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="co"># Reorder the sizes:</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>  o &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(sizes)</span>
<span id="cb9-10"><a href="#cb9-10"></a>  </span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="co"># Return the reordered implications</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">lhs =</span> LHS[, o],</span>
<span id="cb9-13"><a href="#cb9-13"></a>              <span class="dt">rhs =</span> RHS[, o]))</span>
<span id="cb9-14"><a href="#cb9-14"></a>  </span>
<span id="cb9-15"><a href="#cb9-15"></a>}</span></code></pre></div>
<p>Once we have defined the function, we add the method to the registry:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>equivalencesRegistry<span class="op">$</span><span class="kw">set_entry</span>(<span class="dt">method =</span> <span class="st">"Reorder"</span>,</span>
<span id="cb10-2"><a href="#cb10-2"></a>                               <span class="dt">fun =</span> reorder,</span>
<span id="cb10-3"><a href="#cb10-3"></a>                               <span class="dt">description =</span> <span class="st">"Reorder the implications according to the size of their left-hand side."</span>)</span></code></pre></div>
<p>If we inspect the registry, we obtain the list of the methods, including the one we have just inserted:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>equivalencesRegistry<span class="op">$</span><span class="kw">get_entry_names</span>()</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; [1] "Composition"    "Generalization" "Reduction"      "Simplification"</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; [5] "Reorder"</span></span></code></pre></div>
<p>We can apply the reorder method:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Original implications</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>fc<span class="op">$</span>implications</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt; Implication set with 10 implications.</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; Rule 1: {no_moon} -&gt; {small, near}</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt; Rule 2: {far} -&gt; {moon}</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt; Rule 3: {near} -&gt; {small}</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; Rule 4: {large} -&gt; {far, moon}</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; Rule 5: {medium} -&gt; {far, moon}</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt; Rule 6: {medium, large, far, moon} -&gt; {small, near, no_moon}</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt; Rule 7: {small, near, moon, no_moon} -&gt; {medium, large, far}</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt; Rule 8: {small, near, far, moon} -&gt; {medium, large, no_moon}</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt; Rule 9: {small, large, far, moon} -&gt; {medium, near, no_moon}</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt; Rule 10: {small, medium, far, moon} -&gt; {large, near, no_moon}</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Apply the reorder method</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>fc<span class="op">$</span>implications<span class="op">$</span><span class="kw">apply_rules</span>(<span class="st">"reorder"</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; Processing batch</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; --&gt; Reorder: from 10 to 10 in 0.001 secs.</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; Batch took 0.006 secs.</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Reordered implications</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>fc<span class="op">$</span>implications</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; Implication set with 10 implications.</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt; Rule 1: {far} -&gt; {moon}</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; Rule 2: {near} -&gt; {small}</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; Rule 3: {no_moon} -&gt; {small, near}</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; Rule 4: {large} -&gt; {far, moon}</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; Rule 5: {medium} -&gt; {far, moon}</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt; Rule 6: {medium, large, far, moon} -&gt; {small, near, no_moon}</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt; Rule 7: {small, near, moon, no_moon} -&gt; {medium, large, far}</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; Rule 8: {small, near, far, moon} -&gt; {medium, large, no_moon}</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt; Rule 9: {small, large, far, moon} -&gt; {medium, near, no_moon}</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">#&gt; Rule 10: {small, medium, far, moon} -&gt; {large, near, no_moon}</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#the-registry">The Registry</a></li>
      <li><a href="#use-of-the-rules">Use of the Rules</a></li>
      <li><a href="#definition-of-new-equivalence-rules">Definition of New Equivalence Rules</a></li>
      <li><a href="#an-example">An Example</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Domingo Lopez Rodriguez, Angel Mora, Jesus Dominguez, Ana Villalon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
